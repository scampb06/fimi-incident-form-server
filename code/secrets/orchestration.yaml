# Auto Archiver Configuration

# Steps are the modules that will be run in the order they are defined
steps:
  feeders:
  - cli_feeder
  - gsheet_feeder_db  
  extractors:
  - telegram_extractor
  - generic_extractor
  - antibot_extractor_enricher
  - wacz_extractor_enricher
  - wayback_extractor_enricher
  enrichers:
  - timestamping_enricher
  - metadata_enricher 
  - meta_enricher
  - thumbnail_enricher
  - ssl_enricher
  - pdq_hash_enricher
  - antibot_extractor_enricher
  - hash_enricher
  - wacz_extractor_enricher
  - wayback_extractor_enricher
  databases:
  - csv_db
  - console_db
  - gsheet_feeder_db
  storages:
  # - gdrive_storage
  - s3_storage
  formatters:
  - html_formatter

# Global configuration

# Authentication
# a dictionary of authentication information that can be used by extractors to login to website. 
# you can use a comma separated list for multiple domains on the same line (common usecase: x.com,twitter.com)
# Common login 'types' are username/password, cookie, api key/token.
# There are two special keys for using cookies, they are: cookies_file and cookies_from_browser. 
# Some Examples:
# facebook.com:
#   username: "my_username"
#   password: "my_password"
# or for a site that uses an API key:
# twitter.com,x.com:
#   api_key
#   api_secret
# youtube.com:
#   cookie: "login_cookie=value ; other_cookie=123" # multiple 'key=value' pairs should be separated by ;

authentication: {}

# These are the global configurations that are used by the modules

logging:
  level: INFO

  file:
  rotation:
  each_level_in_separate_file: false
gsheet_feeder_db:
  sheet: null
  sheet_id: null
  header: 1
  service_account: /mnt/fileshare/secrets/service_account.json
  columns:
    url: URL
    status: Archive Status
    folder: Destination Folder
    archive: Archive URL
    date: Archive Date
    thumbnail: Thumbnail
    timestamp: Upload Timestamp
    title: Upload Title
    text: Text Content
    screenshot: Screenshot
    hash: Hash
    pdq_hash: Perceptual Hashes
    wacz: WACZ
    replaywebpage: ReplayWebpage
  allow_worksheets: []
  block_worksheets: []
  use_sheet_names_in_stored_paths: true
html_formatter:
  detect_thumbnails: true
csv_db:
  csv_file: db.csv
thumbnail_enricher:
  thumbnails_per_minute: 60
  max_thumbnails: 16
ssl_enricher:
  skip_when_nothing_archived: true
generic_extractor:
  subtitles: true
  comments: false
  livestreams: false
  live_from_start: false
  proxy: ''
  proxy_on_failure_only: true
  end_means_success: true
  allow_playlist: false
  max_downloads: inf
  bguils_po_token_method: disabled  # Disabled to avoid bgutils installation overhead
  extractor_args: {}
  ytdlp_update_interval: 5
  ytdlp_args: ''
gdrive_storage:
  path_generator: url
  filename_generator: static
  root_folder_id: ''
  oauth_token:
  service_account: /mnt/fileshare/secrets/service_account.json
s3_storage:
  path_generator: url
  filename_generator: static
  bucket: ''
  region: ''
  key: ''
  secret: ''
  random_no_duplicate: false
  endpoint_url: ''
  cdn_url: ''
  private: true  # Changed to true - use bucket policy for public access instead of ACLs
antibot_extractor_enricher:
  save_to_pdf: false
  max_download_images: 50
  max_download_videos: 50
  user_data_dir: null  # Disabled - not needed in Docker
  detect_auth_wall: true
  proxy:
wayback_extractor_enricher:
  timeout: 15
  if_not_archived_within: null
  key: ''
  secret: ''
  proxy_http: null
  proxy_https: null
wacz_extractor_enricher:
  profile: null
  docker_commands:
    - docker
    - run
    - --rm
    - -v
    - /app/local_archive:/crawls/
    - webrecorder/browsertrix-crawler:1.9.2
  timeout: 120
  extract_media: false
  extract_screenshot: true
  socks_proxy_host: null
  socks_proxy_port: null
  proxy_server: null
  behaviors: null  # Force fresh browser state for each URL
  profile_name: null  # Don't reuse profiles
timestamping_enricher:
  tsa_urls:
    - http://timestamp.identrust.com
    - http://timestamp.ssl.trustwave.com
    - http://zeitstempel.dfn.de
    - http://ts.ssl.com
    - http://tsa.lex-persona.com/tsa
    - http://tss.cnbs.gob.hn/TSS/HttpTspServer
  cert_authorities: null
  allow_selfsigned: false
hash_enricher:
  algorithm: SHA-256
  chunksize: 16000000
